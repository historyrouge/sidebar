"use strict";
"use client";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.GeneratedImageCard = GeneratedImageCard;
const jsx_runtime_1 = require("react/jsx-runtime");
const image_1 = __importDefault(require("next/image"));
const button_1 = require("./ui/button");
const lucide_react_1 = require("lucide-react");
const use_toast_1 = require("@/hooks/use-toast");
function GeneratedImageCard({ imageDataUri, prompt }) {
    const { toast } = (0, use_toast_1.useToast)();
    const handleDownload = () => {
        const link = document.createElement('a');
        link.href = imageDataUri;
        link.download = `${prompt.substring(0, 20).replace(/\s+/g, '_')}.png`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        toast({ title: "Image downloaded!" });
    };
    const handleShare = () => {
        if (navigator.share) {
            fetch(imageDataUri)
                .then(res => res.blob())
                .then(blob => {
                const file = new File([blob], 'generated_image.png', { type: 'image/png' });
                navigator.share({
                    title: 'Image from SearnAI',
                    text: `Image generated from prompt: "${prompt}"`,
                    files: [file],
                }).catch(error => console.log('Error sharing', error));
            });
        }
        else {
            navigator.clipboard.writeText(imageDataUri);
            toast({ title: "Copied!", description: "Image data URL copied to clipboard." });
        }
    };
    return ((0, jsx_runtime_1.jsxs)("div", { className: "w-full max-w-sm rounded-xl border bg-card/50 overflow-hidden", children: [(0, jsx_runtime_1.jsx)("div", { className: "relative aspect-square", children: (0, jsx_runtime_1.jsx)(image_1.default, { src: imageDataUri, alt: prompt, fill: true, className: "object-cover" }) }), (0, jsx_runtime_1.jsxs)("div", { className: "p-3", children: [(0, jsx_runtime_1.jsx)("p", { className: "font-semibold text-sm line-clamp-2", children: prompt }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-muted-foreground", children: "Generated by Imagen" }), (0, jsx_runtime_1.jsxs)("div", { className: "mt-3 flex gap-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", size: "sm", className: "w-full", onClick: handleDownload, children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Download, { className: "mr-2 h-4 w-4" }), "Download"] }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "ghost", size: "icon", onClick: handleShare, children: (0, jsx_runtime_1.jsx)(lucide_react_1.Share2, { className: "h-4 w-4" }) })] })] })] }));
}
